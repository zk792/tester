# AutoAPI Tester 使用手册

欢迎使用 **AutoAPI Tester**。这是一款基于 AI 的自动化接口测试工具，能够根据您的 API 文档自动生成测试用例，执行测试，并生成详细报告。

---

## 🚀 快速开始

### 1. 配置 AI 模型 (AI 设置)
在开始之前，您需要配置一个 AI 模型来分析您的文档。

1.  进入左侧面板的 **"AI 设置"** 标签页。
2.  **选择提供商**：支持 Google Gemini (推荐)、DeepSeek、通义千问、OpenAI。
3.  **输入 API Key**：输入对应厂商的 API Key。
    *   *注意：Key 仅保存在您的本地浏览器内存中，刷新页面后需重新输入，确保安全。*
4.  **模型名称**：通常使用默认即可（如 `gemini-2.5-flash` 或 `deepseek-chat`）。

### 2. 导入 API 文档
告诉 AI 您要测试什么接口。

1.  进入 **"文档"** 标签页。
2.  **导入方式**：
    *   **粘贴文本**：直接粘贴 Swagger JSON, YAML, cURL 命令或纯文本接口说明。
    *   **上传文件**：点击 "导入文件" 按钮，支持 `.json`, `.md`, `.txt`, `.pdf`, `.docx` 格式。
3.  文档越清晰，生成的测试用例越准确。

### 3. 生成测试用例
1.  点击左下角的 **"生成测试用例"** 按钮。
2.  系统会分析文档，并在右侧生成一份包含正常场景和异常场景的测试计划。
3.  生成后，系统会自动提取文档中的 `Base URL` (基础地址) 和 `Token` (如果存在)。

---

## 🌐 网络连接模式 (核心功能)

由于浏览器的安全限制 (CORS)，或者是为了访问您公司内网的接口，选择正确的连接模式至关重要。

在 **"基础"** 设置标签页中，有三种模式可选：

### 1. ☁️ 云端代理 (Cloud Proxy) - *推荐公网接口*
*   **原理**：请求由部署在公网的服务器转发。
*   **适用场景**：测试部署在公网的 API（如 `https://api.example.com`）。
*   **优点**：无需安装任何插件或软件，解决跨域问题。
*   **限制**：无法访问您的 `localhost` 或 `192.168.x.x` 内网地址。

### 2. 💻 本地代理 (Local Agent) - *推荐内网/本地开发*
*   **原理**：在您的电脑上运行一个微型代理服务，网页将请求发给本地代理，由本地代理转发给目标接口。
*   **适用场景**：测试 `localhost:8080`、`127.0.0.1` 或公司内网服务器。
*   **使用步骤**：
    1.  选择 "本地代理" 模式。
    2.  **下载客户端**：
        *   **Windows 用户**：点击 **"下载 Windows 客户端 (.exe)"**，下载后双击运行即可（会出现一个黑色窗口，不要关闭）。
        *   **开发者**：点击 **"下载 .js 脚本"**，需安装 Node.js，运行 `node local-agent.js`。
    3.  确保代理已启动（通常监听在 `http://localhost:3001`）。
    4.  现在您可以正常测试内网接口了。

### 3. 🌐 浏览器直连 (Direct)
*   **原理**：由浏览器直接发起 Ajax/Fetch 请求。
*   **适用场景**：目标 API 支持 CORS（跨域资源共享）且允许当前域名访问。
*   **注意**：如果遇到 "Network Error" 或无响应，通常是因为浏览器拦截了跨域请求。请切换到代理模式。

---

## ⚙️ 参数配置

### 基础参数
*   **Base URL**: 接口的基础地址（例如 `http://localhost:8080`）。
*   **Auth Token**: 如果接口需要登录，在此填入 Token（通常是 Bearer Token）。系统会自动将其添加到请求头中。

### 全局参数 (Advanced)
进入 **"全局"** 标签页，您可以设置对所有请求生效的参数：
*   **全局 Header**: 例如 `X-App-ID`, `Accept-Language` 等。
*   **全局 Query**: 会自动拼接到所有 URL 后面（例如 `?api_key=xxx`）。
*   **全局 Body**: 会自动合并到所有 POST/PUT 请求的 JSON 体中（例如业务必须的 `nonce` 或 `timestamp`）。

---

## ▶️ 执行与报告

1.  **运行测试**：
    *   点击右上角的 **"运行所有测试"**。
    *   或者点击单个测试用例行，展开详情。
2.  **查看结果**：
    *   **绿色 (PASS)**: 状态码符合预期。
    *   **红色 (FAIL)**: 状态码不符合预期。
    *   **黄色 (ERROR)**: 网络错误或超时。
3.  **查看详情**：
    *   点击测试用例行，可以查看完整的 **Request Headers/Body** 和 **Response Body**。
4.  **导出报告**：
    *   点击右上角的 **"导出"** 按钮。
    *   **导出 Markdown**: 生成格式精美的测试报告，适合存档或发送给开发人员。
    *   **导出 ZIP**: 包含报告和原始 JSON 数据，用于从外部系统导入或深度分析。

---

## ❓ 常见问题 (FAQ)

**Q: 为什么测试结果全是 "ERROR"?**
A: 请检查：
1.  如果是内网接口，是否开启了 **本地代理** 并且运行了 exe 文件？
2.  如果是公网接口，尝试切换到 **云端代理** 模式。
3.  检查 Base URL 是否正确。

**Q: AI 提示 "模型未返回任何内容"?**
A: 可能是 API Key 无效或额度已用完，或者文档内容过多导致模型超时。尝试精简文档或更换模型提供商。

**Q: 如何测试需要登录的接口？**
A: 先在其他工具（如 Postman 或 浏览器）登录拿到 Token，然后填入 **Auth Token** 字段。

**Q: 文件上传支持什么格式？**
A: PDF, DOCX (Word), JSON, Markdown, TXT。注意：扫描版 PDF（纯图片）可能无法被准确识别。
